import{r as e,c as s,h as t,g as i}from"./p-2eb42df6.js";const o=class{constructor(t){e(this,t),this.giveMeSeed=s(this,"giveMeSeed",7)}componentDidLoad(){let e=this.element.querySelector("iframe");window.addEventListener("message",s=>{s.data.appIdentity&&(s.data.appIdentity===this.digestSeedHex&&e.contentWindow.postMessage({seed:this.seed},e.src),s.stopImmediatePropagation()),"completed"===s.data.status&&(e.contentWindow.location.reload(),s.stopImmediatePropagation())})}componentWillLoad(){return new Promise(e=>{this.giveMeSeed.emit({appName:this.appName,callback:(s,t)=>{if(s)throw s;this.seed=t,this.digestSeedHex=this.digestMessage(t),e()}})})}sendMessageToIframe(e,s){(s=>{$$.interactions.startSwarmAs(e,"echo","say",s).onReturn((function(e,s){e?console.log(e):(console.log("Iframe received: ",s),setTimeout(()=>{},1e4))}))})(s)}digestMessage(e){return require("pskcrypto").pskHash(e,"hex")}render(){let e=window.parent.location+"iframe/"+this.digestSeedHex;return t("iframe",{sandbox:"allow-scripts allow-same-origin allow-forms",frameborder:"0",style:{overflow:"hidden",height:"100%",width:"100%"},src:e})}get element(){return i(this)}};export{o as psk_ss_app};