import{g as e}from"./p-2eb42df6.js";import{b as t,c as n}from"./p-acb9d1e1.js";import{a as i,c as r}from"./p-7111d76e.js";function l(e,i){if(i.hasAttribute(t)){let n=i.getAttribute(t).trim();return void 0!==e.getChainValue(n)}if(i.hasAttribute(n)){let t=i.getAttribute(n).split("|");if(2!==t.length)return!1;let r=t[0].trim();return t[1].trim()===e.getChainValue(r)}return!0}function o(e){let t=this;Object.keys(e).forEach((function(n){t[n]=e[n]}))}function u(e,t,n,r,l){let o=this;return Array.from(r.attributes).filter(e=>e.name.startsWith(n)).forEach(l=>{const u=l.name.split(n)[1],a=i(u),c=e?`${e}.${l.value}`:l.value,f=t.getChainValue(c);r.setAttribute(u,f),o[a]=t.getChainValue(c)}),l()}function a(e,t,n,r,l){let o=this;return Array.from(r.attributes).filter(e=>e.value.startsWith(n)).forEach(l=>{const u=l.value.split(n)[1],a=e?`${e}.${u}`:u,c=i(l.name);if(t.hasExpression(a))o[c]=t.evaluateExpression(a),t.onChangeExpressionChain(a,(function(){o[c]=t.evaluateExpression(a)}));else{const e=t.getChainValue(a);r.setAttribute(l.name,e),o[c]=e,t.onChange(a,(function(){o[c]=t.getChainValue(a)}))}}),l()}function c(e,t){try{let n=this;if(n.rootModel){let i=e;return n.parentChain&&(i=`${n.parentChain}.${e}`),n.rootModel.setChainValue(i,t),!0}return!1}catch(n){console.error(n)}return!1}function f(t,n,i){if(t||!n)return i();let r,o,c,f=this,d=e(f);if(!l(n,d))return d.setAttribute("data-hide","hide"),i();if(d.removeAttribute("data-hide"),null!==d.getAttribute("data-view-model")&&"psk-for-each"===d.tagName.toLowerCase())return r=d.getAttribute("data-view-model"),f.__assignProperties.call(f,{rootModel:n,parentChain:c=r}),i();if(r=d.getAttribute("view-model"),c=r,null===r&&(null!==(o=null===d.getAttribute("name")||d.getAttribute("name").startsWith("@")?null:d.getAttribute("name"))||null===d.getAttribute("label")||d.getAttribute("label").startsWith("@")||(o=d.getAttribute("label").replace(/( |:|\/|\.|-)/g,"").toLowerCase()),c=o),!r&&!o)return a.call(f,c,n,"@",d,i),u.call(f,c,n,"view-model-",d,i),i();function s(e,t){f[e]=n.getChainValue(t),n.onChange(t,(function(){f[e]=n.getChainValue(t)}))}if(f.__assignProperties.call(f,{rootModel:n,parentChain:c}),r){let e=n.getChainValue(c);return e?(Object.keys(e).forEach(e=>{s(e,`${c}.${e}`)}),function(){const e=`${c}.value`;if(!n.getChainValue(c)||n.getChainValue(e))return i();s("value",e)}(),i()):i()}return i()}function d(){return t=>{let{componentWillLoad:n,render:i}=t;t.render=function(){let t=e(this),n=t.className;return t.className="hide"===t.getAttribute("data-hide")?`${n} hidden`:n.replace(" hidden",""),i&&i.call(this)},t.componentWillLoad=function(){let t=this,i=e(t);return t.changeModel=c,t.__assignProperties=o,i.isConnected?0===i.getAttributeNames().filter(e=>"data-view-model"===e.toLowerCase()||!!e.toLowerCase().includes("view-model")||!!i.getAttribute(e).toLowerCase().startsWith("@")).length?n&&n.call(t):new Promise(e=>{!function(e){r("getModelEvent",{bubbles:!0,composed:!0,cancellable:!0,detail:{callback:function(n,i){f.apply(t,[n,i,e])}}},!0,i)}(()=>{e(n&&n.call(t))})}):n&&n.call(t)}}}export{d as B,l as _};