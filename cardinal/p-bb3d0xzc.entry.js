import{r as t,h as e,g as s}from"./p-2eb42df6.js";import"./p-acb9d1e1.js";import{e as i,s as o,c as r}from"./p-7111d76e.js";import{T as n}from"./p-f3fbe684.js";import{C as c}from"./p-6a61ad0f.js";function a(){let t=this.element,e=Array.from(this.element.querySelectorAll("psk-chapter"));this.activeChapter=null;const s=t.scrollTop,o=t.offsetHeight;let r=function(t){let e=[];return t.forEach(t=>{const s=t.getAttribute("guid");if(!s)return null;const o=t.getElementsByClassName("card psk-card")?t.getElementsByClassName("card psk-card")[0]:null;if(!o)return null;const r=function(t,e){let s=t.offsetTop;const o=t.offsetHeight;let r=e[e.length-1]?e[e.length-1]:null;if(r){let{verticalOffset:n,height:c}=r;if(n>s||n+c>s+o){const o=i(t,"psk-chapter",2),r=e.find(t=>o&&t.guid===o.getAttribute("guid"));r&&(s+=r.verticalOffset)}}return s}(o,e);e.push({guid:s,height:o.offsetHeight,verticalOffset:r,title:t.title})}),e}(e);l.call(this,r,s,o)}function l(t,e,s){let i=t.find(t=>e<=t.verticalOffset&&t.verticalOffset+t.height<=e+s);if(i)return void(this.activeChapter=i.guid);let o=t.filter(t=>e>=t.verticalOffset&&(e+s<=t.verticalOffset+t.height||e<=t.verticalOffset+t.height));o.length>0?this.activeChapter=o[o.length-1].guid:t.length>0&&(this.activeChapter=t[0].guid)}var h=function(t,e,s,i){var o,r=arguments.length,n=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,s,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(n=(r<3?o(n):r>3?o(e,s,n):o(e,s))||n);return r>3&&n&&Object.defineProperty(e,s,n),n};const p=class{constructor(e){t(this,e),this.hasToc=!1,this.activeChapter=null,this.chapters=[],this.pageClass="",this.title="",this.subTitle="",this.componentFullyLoaded=!1,this.__handleScrollEvent=t=>{let e=this;t.preventDefault(),t.stopImmediatePropagation(),clearTimeout(this.__isScrolling),this.__isScrolling=setTimeout((function(){a.call(e)}),100)}}render(){this.hasToc&&this._sendTableOfContentChapters();const t=e("div",{class:"toc"},e("slot",{name:"toc"}));return e("div",{class:`main-container ${this.pageClass}"`},this.badgeText?e("div",{class:"psk-badge",style:{backgroundColor:this.badgeBackgroundColor}},e("div",{class:"psk-badge-text",style:{color:this.badgeTextColor}},this.badgeText)):null,e("div",{class:"page-title"},e("h1",null,this.title)),this.subTitle?e("div",{class:"page-subtitle"},e("h2",null,this.subTitle)):null,e("div",{class:"page-content"},this.componentFullyLoaded&&this.hasToc&&t,e("div",{class:"container"},this.componentFullyLoaded?e("div",{class:"container-content"},e("slot",null)):e("psk-ui-loader",{shouldBeRendered:!0}))))}receiveChapters(t){if(t.stopImmediatePropagation(),!t.detail)return;const e=Object.assign({},t.detail),s=this.chapters.findIndex(t=>e.guid===t.guid),i=[...this.chapters];if(-1===s)return i.push(Object.assign({},e)),void(this.chapters=JSON.parse(JSON.stringify(i)));i[s]=Object.assign({},e),this.chapters=JSON.parse(JSON.stringify(i))}_checkForChapterScrolling(){if(-1===window.location.href.indexOf("chapter="))return;const t=window.location.href.split("chapter=")[1];setTimeout(()=>{o(t,this.element)},50)}_sendTableOfContentChapters(){r("psk-send-toc",{bubbles:!0,composed:!0,cancelable:!0,detail:{chapters:this.chapters,active:this.activeChapter}},!0)}connectedCallback(){null!==this.element.querySelector("psk-toc")&&(this.element.querySelector("psk-toc").setAttribute("slot","toc"),this.hasToc=!0)}componentDidLoad(){this.componentFullyLoaded=!0,this._checkForChapterScrolling(),this.element.addEventListener("scroll",this.__handleScrollEvent,!0)}disconnectedCallback(){this.element.removeEventListener("scroll",this.__handleScrollEvent,!0)}get element(){return s(this)}};h([c()],p.prototype,"hasToc",void 0),h([n({description:"This property is used as the page title",isMandatory:!1,propertyType:"string"})],p.prototype,"title",void 0),h([n({description:"This property is used as the page sub-title",isMandatory:!1,propertyType:"string"})],p.prototype,"subTitle",void 0),h([n({description:"This property is the name of the table of content.",isMandatory:!1,propertyType:"string"})],p.prototype,"tocTitle",void 0),h([n({description:"This property sets the text of the badge.",isMandatory:!1,propertyType:"string"})],p.prototype,"badgeText",void 0),h([n({description:"This property sets the color of the badge text.",isMandatory:!1,propertyType:"string"})],p.prototype,"badgeTextColor",void 0),h([n({description:"This property sets the background color of the badge.",isMandatory:!1,propertyType:"string"})],p.prototype,"badgeBackgroundColor",void 0);export{p as psk_page};