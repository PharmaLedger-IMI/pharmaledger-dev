import{g as t}from"./p-9835b40a.js";import{b as e,d as n,e as r,c as l}from"./p-869e3fb2.js";function o(t,r){if(r.hasAttribute(e)){let n=r.getAttribute(e).trim();return void 0!==t.getChainValue(n)}if(r.hasAttribute(n)){let e=r.getAttribute(n).split("|");if(2!==e.length)return!1;let l=e[0].trim();return e[1].trim()===t.getChainValue(l)}return!0}function i(t){let e=this;Object.keys(t).forEach((function(n){e[n]=t[n]}))}function u(e,n,l,o){let i=this;const u=t(i);return Array.from(u.attributes).filter(t=>t.name.startsWith(l)).forEach(t=>{const o=r(t.name.split(l)[1]);i[o]=n.getChainValue(e?`${e}.${t.value}`:t.value)}),o()}function a(e,n,l,o){let i=this;const u=t(i);return Array.from(u.attributes).filter(t=>t.value.startsWith(l)).forEach(t=>{const o=t.value.split(l)[1],u=e?`${e}.${o}`:o,a=r(t.name);n.hasExpression(u)?i[a]=n.evaluateExpression(u):(i[a]=n.getChainValue(u),n.onChange(u,(function(){i[a]=n.getChainValue(u)})))}),o()}function c(t,e){try{let n=this;if(n.rootModel){let r=t;return n.parentChain&&(r=`${n.parentChain}.${t}`),n.rootModel.setChainValue(r,e),!0}return!1}catch(n){console.error(n)}return!1}function f(e,n,r){if(e||!n)return r();let l,i,c,f=this,s=t(f);if(!o(n,s))return s.remove(),r();if(null!==s.getAttribute("data-view-model")&&"psk-for-each"===s.tagName.toLowerCase())return l=s.getAttribute("data-view-model"),f.__assignProperties.call(f,{rootModel:n,parentChain:c=l}),r();if(l=s.getAttribute("view-model"),c=l,null===l&&(null!==(i=null===s.getAttribute("name")||s.getAttribute("name").startsWith("@")?null:s.getAttribute("name"))||null===s.getAttribute("label")||s.getAttribute("label").startsWith("@")||(i=s.getAttribute("label").replace(/( |:|\/|\.|-)/g,"").toLowerCase()),c=i),!l&&!i)return a.call(f,c,n,"@",r),u.call(f,c,n,"view-model-",r),r();function d(t,e){f[t]=n.getChainValue(e),n.onChange(e,(function(){f[t]=n.getChainValue(e)}))}if(f.__assignProperties.call(f,{rootModel:n,parentChain:c}),l){let t=n.getChainValue(c);return t?(Object.keys(t).forEach(t=>{d(t,`${c}.${t}`)}),function(){const t=`${c}.value`;if(!n.getChainValue(c)||n.getChainValue(t))return r();d("value",t)}(),r()):r()}return r()}function s(){return e=>{let{componentWillLoad:n}=e;e.componentWillLoad=function(){let e=this,r=t(e);return e.changeModel=c,e.__assignProperties=i,r.isConnected?0===r.getAttributeNames().filter(t=>"data-view-model"===t.toLowerCase()||!!t.toLowerCase().includes("view-model")||!!r.getAttribute(t).toLowerCase().startsWith("@")).length?n&&n.call(e):new Promise(t=>{!function(t){l("getModelEvent",{bubbles:!0,composed:!0,cancellable:!0,detail:{callback:function(n,r){f.apply(e,[n,r,t])}}},!0,r)}(()=>{t(n&&n.call(e))})}):n&&n.call(e)}}}export{s as B,o as _};