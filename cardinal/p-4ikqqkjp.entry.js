import{r as t,h as s,g as e}from"./p-2eb42df6.js";import"./p-acb9d1e1.js";import{e as i,s as n,c as o}from"./p-7111d76e.js";import{T as r}from"./p-f3fbe684.js";import{C as c}from"./p-6a61ad0f.js";function l(){let t=this.element,s=Array.from(this.element.querySelectorAll("psk-chapter"));this.activeChapter=null;const e=t.scrollTop,n=t.offsetHeight;let o=function(t){let s=[];return t.forEach(t=>{const e=t.getAttribute("guid");if(!e)return null;const n=t.getElementsByClassName("card psk-card")?t.getElementsByClassName("card psk-card")[0]:null;if(!n)return null;const o=function(t,s){let e=t.offsetTop;const n=t.offsetHeight;let o=s[s.length-1]?s[s.length-1]:null;if(o){let{verticalOffset:r,height:c}=o;if(r>e||r+c>e+n){const n=i(t,"psk-chapter",2),o=s.find(t=>n&&t.guid===n.getAttribute("guid"));o&&(e+=o.verticalOffset)}}return e}(n,s);s.push({guid:e,height:n.offsetHeight,verticalOffset:o,title:t.title})}),s}(s);a.call(this,o,e,n)}function a(t,s,e){let i=t.find(t=>s<=t.verticalOffset&&t.verticalOffset+t.height<=s+e);if(i)return void(this.activeChapter=i.guid);let n=t.filter(t=>s>=t.verticalOffset&&(s+e<=t.verticalOffset+t.height||s<=t.verticalOffset+t.height));n.length>0?this.activeChapter=n[n.length-1].guid:t.length>0&&(this.activeChapter=t[0].guid)}var h=function(t,s,e,i){var n,o=arguments.length,r=o<3?s:null===i?i=Object.getOwnPropertyDescriptor(s,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,s,e,i);else for(var c=t.length-1;c>=0;c--)(n=t[c])&&(r=(o<3?n(r):o>3?n(s,e,r):n(s,e))||r);return o>3&&r&&Object.defineProperty(s,e,r),r};const p=class{constructor(s){t(this,s),this.hasToc=!1,this.activeChapter=null,this.chapters=[],this.pageClass="",this.title="",this.subTitle="",this.componentFullyLoaded=!1,this.__handleScrollEvent=t=>{let s=this;t.preventDefault(),t.stopImmediatePropagation(),clearTimeout(this.__isScrolling),this.__isScrolling=setTimeout((function(){l.call(s)}),100)}}render(){this.hasToc&&this._sendTableOfContentChapters();const t=s("div",{class:"toc"},s("slot",{name:"toc"}));return s("div",{class:`main-container ${this.pageClass}"`},s("div",{class:"page-title"},s("h1",null,this.title)),this.subTitle?s("div",{class:"page-subtitle"},s("h2",null,this.subTitle)):null,s("div",{class:"page-content"},this.componentFullyLoaded&&this.hasToc&&t,s("div",{class:"container"},this.componentFullyLoaded?s("div",{class:"container-content"},s("slot",null)):s("psk-ui-loader",{shouldBeRendered:!0}))))}receiveChapters(t){if(t.stopImmediatePropagation(),!t.detail)return;const s=Object.assign({},t.detail),e=this.chapters.findIndex(t=>s.guid===t.guid),i=[...this.chapters];if(-1===e)return i.push(Object.assign({},s)),void(this.chapters=JSON.parse(JSON.stringify(i)));i[e]=Object.assign({},s),this.chapters=JSON.parse(JSON.stringify(i))}_checkForChapterScrolling(){if(-1===window.location.href.indexOf("chapter="))return;const t=window.location.href.split("chapter=")[1];setTimeout(()=>{n(t,this.element)},50)}_sendTableOfContentChapters(){o("psk-send-toc",{bubbles:!0,composed:!0,cancelable:!0,detail:{chapters:this.chapters,active:this.activeChapter}},!0)}connectedCallback(){null!==this.element.querySelector("psk-toc")&&(this.element.querySelector("psk-toc").setAttribute("slot","toc"),this.hasToc=!0)}componentDidLoad(){this.componentFullyLoaded=!0,this._checkForChapterScrolling(),this.element.addEventListener("scroll",this.__handleScrollEvent,!0)}disconnectedCallback(){this.element.removeEventListener("scroll",this.__handleScrollEvent,!0)}get element(){return e(this)}};h([c()],p.prototype,"hasToc",void 0),h([r({description:"This property is used as the page title",isMandatory:!1,propertyType:"string"})],p.prototype,"title",void 0),h([r({description:"This property is used as the page sub-title",isMandatory:!1,propertyType:"string"})],p.prototype,"subTitle",void 0),h([r({description:"This property is the name of the table of content.",isMandatory:!1,propertyType:"string"})],p.prototype,"tocTitle",void 0);export{p as psk_page};